// Generated by CoffeeScript 2.7.0
var splitByTopLevelPipe;

export var parseExpr = function(expr) {
  var parts;
  if (expr.startsWith('(') && expr.endsWith(')')) {
    expr = expr.slice(1, -1);
  }
  parts = splitByTopLevelPipe(expr);
  return parts.map(function(part) {
    if (part.startsWith('(') && part.endsWith(')')) {
      return parseExpr(part);
    } else {
      return part;
    }
  });
};

splitByTopLevelPipe = function(expr) {
  var char, i, j, len, level, part, parts;
  parts = [];
  part = '';
  level = 0;
  for (i = j = 0, len = expr.length; j < len; i = ++j) {
    char = expr[i];
    if (char === '(') {
      level++;
    } else if (char === ')') {
      level--;
    }
    if (char === '|' && level === 0) {
      parts.push(part);
      part = '';
    } else {
      part += char;
    }
  }
  if (part) {
    parts.push(part);
  }
  return parts;
};

// expr = ""
// for i in _.range 100
//     expr += "(1234|Andersson_Arne|(12w1|13b½|13b½|13b½|13b½|13b½|13b½|13b½|13b½|13b½|13b½))"
// start = new Date()
// expr = expr.replaceAll '_', ' '
// expr = expr.replaceAll ')(', ')|('
// expr = '(' + expr + ')'
// result = parseExpr expr
// console.log new Date() - start
// console.log result

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2VyLmpzIiwic291cmNlUm9vdCI6Ii4uXFwiLCJzb3VyY2VzIjpbImNvZmZlZVxccGFyc2VyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQTs7QUFBQSxPQUFBLElBQU8sU0FBQSxHQUFZLFFBQUEsQ0FBQyxJQUFELENBQUE7QUFDbkIsTUFBQTtFQUFFLElBQUcsSUFBSSxDQUFDLFVBQUwsQ0FBZ0IsR0FBaEIsQ0FBQSxJQUF5QixJQUFJLENBQUMsUUFBTCxDQUFjLEdBQWQsQ0FBNUI7SUFBb0QsSUFBQSxHQUFPLElBQUksQ0FBQyxLQUFMLENBQVcsQ0FBWCxFQUFjLENBQUMsQ0FBZixFQUEzRDs7RUFDQSxLQUFBLEdBQVEsbUJBQUEsQ0FBb0IsSUFBcEI7U0FDUixLQUFLLENBQUMsR0FBTixDQUFVLFFBQUEsQ0FBQyxJQUFELENBQUE7SUFBVSxJQUFHLElBQUksQ0FBQyxVQUFMLENBQWdCLEdBQWhCLENBQUEsSUFBeUIsSUFBSSxDQUFDLFFBQUwsQ0FBYyxHQUFkLENBQTVCO2FBQW9ELFNBQUEsQ0FBVSxJQUFWLEVBQXBEO0tBQUEsTUFBQTthQUF3RSxLQUF4RTs7RUFBVixDQUFWO0FBSGlCOztBQUtuQixtQkFBQSxHQUFzQixRQUFBLENBQUMsSUFBRCxDQUFBO0FBQ3RCLE1BQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsRUFBQSxJQUFBLEVBQUE7RUFBRSxLQUFBLEdBQVE7RUFDUixJQUFBLEdBQU87RUFDUCxLQUFBLEdBQVE7RUFDUixLQUFBLDhDQUFBOztJQUNFLElBQUcsSUFBQSxLQUFRLEdBQVg7TUFBb0IsS0FBQSxHQUFwQjtLQUFBLE1BQ0ssSUFBRyxJQUFBLEtBQVEsR0FBWDtNQUFtQixLQUFBLEdBQW5COztJQUNMLElBQUcsSUFBQSxLQUFRLEdBQVIsSUFBZ0IsS0FBQSxLQUFTLENBQTVCO01BQ0UsS0FBSyxDQUFDLElBQU4sQ0FBVyxJQUFYO01BQ0EsSUFBQSxHQUFPLEdBRlQ7S0FBQSxNQUFBO01BR0ssSUFBQSxJQUFRLEtBSGI7O0VBSEY7RUFPQSxJQUFtQixJQUFuQjtJQUFBLEtBQUssQ0FBQyxJQUFOLENBQVcsSUFBWCxFQUFBOztTQUNBO0FBWm9COztBQUx0QiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBwYXJzZUV4cHIgPSAoZXhwcikgLT5cclxuICBpZiBleHByLnN0YXJ0c1dpdGgoJygnKSBhbmQgZXhwci5lbmRzV2l0aCgnKScpIHRoZW4gZXhwciA9IGV4cHIuc2xpY2UgMSwgLTFcclxuICBwYXJ0cyA9IHNwbGl0QnlUb3BMZXZlbFBpcGUgZXhwclxyXG4gIHBhcnRzLm1hcCAocGFydCkgLT4gaWYgcGFydC5zdGFydHNXaXRoKCcoJykgYW5kIHBhcnQuZW5kc1dpdGgoJyknKSB0aGVuIHBhcnNlRXhwciBwYXJ0IGVsc2UgcGFydFxyXG5cclxuc3BsaXRCeVRvcExldmVsUGlwZSA9IChleHByKSAtPlxyXG4gIHBhcnRzID0gW11cclxuICBwYXJ0ID0gJydcclxuICBsZXZlbCA9IDBcclxuICBmb3IgY2hhciwgaSBpbiBleHByXHJcbiAgICBpZiBjaGFyID09ICcoJyB0aGVuIGxldmVsKytcclxuICAgIGVsc2UgaWYgY2hhciA9PSAnKSd0aGVuIGxldmVsLS1cclxuICAgIGlmIGNoYXIgPT0gJ3wnIGFuZCBsZXZlbCA9PSAwXHJcbiAgICAgIHBhcnRzLnB1c2ggcGFydFxyXG4gICAgICBwYXJ0ID0gJydcclxuICAgIGVsc2UgcGFydCArPSBjaGFyXHJcbiAgcGFydHMucHVzaCBwYXJ0IGlmIHBhcnRcclxuICBwYXJ0c1xyXG5cclxuIyBleHByID0gXCJcIlxyXG4jIGZvciBpIGluIF8ucmFuZ2UgMTAwXHJcbiMgICAgIGV4cHIgKz0gXCIoMTIzNHxBbmRlcnNzb25fQXJuZXwoMTJ3MXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvXwxM2LCvSkpXCJcclxuIyBzdGFydCA9IG5ldyBEYXRlKClcclxuIyBleHByID0gZXhwci5yZXBsYWNlQWxsICdfJywgJyAnXHJcbiMgZXhwciA9IGV4cHIucmVwbGFjZUFsbCAnKSgnLCAnKXwoJ1xyXG4jIGV4cHIgPSAnKCcgKyBleHByICsgJyknXHJcbiMgcmVzdWx0ID0gcGFyc2VFeHByIGV4cHJcclxuIyBjb25zb2xlLmxvZyBuZXcgRGF0ZSgpIC0gc3RhcnRcclxuIyBjb25zb2xlLmxvZyByZXN1bHRcclxuIl19
//# sourceURL=c:\github\2023\044-Monrad\coffee\parser.coffee