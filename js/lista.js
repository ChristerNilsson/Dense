// Generated by CoffeeScript 2.7.0
import {
  g,
  print,
  range,
  scalex,
  scaley
} from './globals.js';

export var Lista = class Lista {
  constructor(objects = [], columnTitles = "", buttons = {}, drawFunction = null) { // a list of players. Or a list of pairs of players
    this.objects = objects;
    this.columnTitles = columnTitles;
    this.buttons = buttons;
    this.drawFunction = drawFunction;
    this.offset = 0;
    this.currentRow = 0;
    this.N = this.objects.length;
    this.paintYellowRow = true;
  }

  draw() { // ritar de rader som syns i f√∂nstret enbart
    var i, iRow, len, p, r, ref, results, s, w, y;
    y = 4;
    s = this.columnTitles;
    textAlign(window.LEFT);
    text(s, 10, scaley(y));
    fill('black');
    r = g.tournament.round - 1;
    ref = range(this.offset, this.offset + g.LPP);
    results = [];
    for (i = 0, len = ref.length; i < len; i++) {
      iRow = ref[i];
      if (iRow >= this.N) {
        continue;
      }
      p = this.objects[iRow];
      y++;
      s = this.drawFunction(p, iRow);
      if (iRow === this.currentRow) {
        fill('yellow');
        w = this.paintYellowRow ? width : scaley(23.4);
        rect(0, scaley(y - 0.5), w, scaley(1));
        fill('black');
      }
      results.push(text(s, 10, scaley(y)));
    }
    return results;
  }

  keyPressed(event, key) {
    return this.buttons[key].click();
  }

  mouseWheel(event) {
    return this.move(event.delta < 0 ? Math.floor(-g.LPP / 2) : Math.floor(g.LPP / 2));
  }

  mousePressed() {
    var button, key, ref, results;
    if (mouseY > scaley(4)) {
      return this.currentRow = this.offset + int(mouseY / g.ZOOM[g.state] - 4.5);
    } else {
      ref = this.buttons;
      results = [];
      for (key in ref) {
        button = ref[key];
        if (button.active && button.inside(mouseX, mouseY)) {
          results.push(button.click());
        } else {
          results.push(void 0);
        }
      }
      return results;
    }
  }

  ArrowUp() {
    return this.move(-1);
  }

  ArrowDown() {
    return this.move(1);
  }

  PageUp() {
    return this.move(Math.floor(-g.LPP / 2));
  }

  PageDown() {
    return this.move(Math.floor(g.LPP / 2));
  }

  Home() {
    return this.move(-this.currentRow);
  }

  End() {
    return this.move(this.N - this.currentRow);
  }

  move(delta) {
    this.currentRow += delta;
    if (this.currentRow < 0) {
      this.currentRow = 0;
    }
    if (this.currentRow >= this.N) {
      this.currentRow = this.N - 1;
    }
    if (this.currentRow < this.offset) {
      this.offset = this.currentRow;
    }
    if (this.currentRow >= this.offset + g.LPP) {
      this.offset = this.currentRow - g.LPP + 1;
    }
    return event.preventDefault();
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdGEuanMiLCJzb3VyY2VSb290IjoiLi5cXCIsInNvdXJjZXMiOlsiY29mZmVlXFxsaXN0YS5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQUE7RUFBUyxDQUFUO0VBQVcsS0FBWDtFQUFpQixLQUFqQjtFQUF1QixNQUF2QjtFQUE4QixNQUE5QjtDQUFBLE1BQUE7O0FBRUEsT0FBQSxJQUFhLFFBQU4sTUFBQSxNQUFBO0VBQ04sV0FBYyxXQUFVLEVBQVYsaUJBQTRCLEVBQTVCLFlBQXlDLENBQUEsQ0FBekMsaUJBQTJELElBQTNELENBQUEsRUFBQTtJQUFDLElBQUMsQ0FBQTtJQUFZLElBQUMsQ0FBQTtJQUFpQixJQUFDLENBQUE7SUFBWSxJQUFDLENBQUE7SUFDM0QsSUFBQyxDQUFBLE1BQUQsR0FBVTtJQUNWLElBQUMsQ0FBQSxVQUFELEdBQWM7SUFDZCxJQUFDLENBQUEsQ0FBRCxHQUFLLElBQUMsQ0FBQSxPQUFPLENBQUM7SUFDZCxJQUFDLENBQUEsY0FBRCxHQUFrQjtFQUpMOztFQU1kLElBQU8sQ0FBQSxDQUFBLEVBQUE7QUFDUixRQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBO0lBQUUsQ0FBQSxHQUFJO0lBQ0osQ0FBQSxHQUFJLElBQUMsQ0FBQTtJQUNMLFNBQUEsQ0FBVSxNQUFNLENBQUMsSUFBakI7SUFDQSxJQUFBLENBQUssQ0FBTCxFQUFPLEVBQVAsRUFBVSxNQUFBLENBQU8sQ0FBUCxDQUFWO0lBRUEsSUFBQSxDQUFLLE9BQUw7SUFDQSxDQUFBLEdBQUksQ0FBQyxDQUFDLFVBQVUsQ0FBQyxLQUFiLEdBQXFCO0FBQ3pCO0FBQUE7SUFBQSxLQUFBLHFDQUFBOztNQUNDLElBQUcsSUFBQSxJQUFRLElBQUMsQ0FBQSxDQUFaO0FBQW1CLGlCQUFuQjs7TUFDQSxDQUFBLEdBQUksSUFBQyxDQUFBLE9B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RCxHQUFVLENBQUMsQ0FBQyxHQUE5QjtNQUF1QyxJQUFDLENBQUEsTUFBRCxHQUFVLElBQUMsQ0FBQSxVQUFELEdBQWMsQ0FBQyxDQUFDLEdBQWhCLEdBQXNCLEVBQXZFOztXQUNBLEtBQUssQ0FBQyxjQUFOLENBQUE7RUFOTTs7QUEzQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnLHByaW50LHJhbmdlLHNjYWxleCxzY2FsZXkgfSBmcm9tICcuL2dsb2JhbHMuanMnIFxyXG5cclxuZXhwb3J0IGNsYXNzIExpc3RhXHJcblx0Y29uc3RydWN0b3IgOiAoQG9iamVjdHM9W10sIEBjb2x1bW5UaXRsZXM9XCJcIiwgQGJ1dHRvbnM9e30sIEBkcmF3RnVuY3Rpb249bnVsbCkgLT4gIyBhIGxpc3Qgb2YgcGxheWVycy4gT3IgYSBsaXN0IG9mIHBhaXJzIG9mIHBsYXllcnNcclxuXHRcdEBvZmZzZXQgPSAwXHJcblx0XHRAY3VycmVudFJvdyA9IDBcclxuXHRcdEBOID0gQG9iamVjdHMubGVuZ3RoXHJcblx0XHRAcGFpbnRZZWxsb3dSb3cgPSB0cnVlXHJcblxyXG5cdGRyYXcgOiAtPiAjIHJpdGFyIGRlIHJhZGVyIHNvbSBzeW5zIGkgZsO2bnN0cmV0IGVuYmFydFxyXG5cdFx0eSA9IDRcclxuXHRcdHMgPSBAY29sdW1uVGl0bGVzXHJcblx0XHR0ZXh0QWxpZ24gd2luZG93LkxFRlRcclxuXHRcdHRleHQgcywxMCxzY2FsZXkoeSlcclxuXHJcblx0XHRmaWxsICdibGFjaydcclxuXHRcdHIgPSBnLnRvdXJuYW1lbnQucm91bmQgLSAxXHJcblx0XHRmb3IgaVJvdyBpbiByYW5nZSBAb2Zmc2V0LEBvZmZzZXQgKyBnLkxQUFxyXG5cdFx0XHRpZiBpUm93ID49IEBOIHRoZW4gY29udGludWVcclxuXHRcdFx0cCA9IEBvYmplY3RzW2lSb3ddXHJcblx0XHRcdHkrK1xyXG5cdFx0XHRzID0gQGRyYXdGdW5jdGlvbiBwLCBpUm93XHJcblx0XHRcdGlmIGlSb3cgPT0gQGN1cnJlbnRSb3dcclxuXHRcdFx0XHRmaWxsICd5ZWxsb3cnXHJcblx0XHRcdFx0dyA9IGlmIEBwYWludFllbGxvd1JvdyB0aGVuIHdpZHRoIGVsc2Ugc2NhbGV5KDIzLjQpXHJcblx0XHRcdFx0cmVjdCAwLCBzY2FsZXkoeSAtIDAuNSksIHcsIHNjYWxleSgxKVxyXG5cdFx0XHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0XHR0ZXh0IHMsMTAsIHNjYWxleSh5KVxyXG5cclxuXHRrZXlQcmVzc2VkIDogKGV2ZW50LCBrZXkpIC0+IEBidXR0b25zW2tleV0uY2xpY2soKVxyXG5cdG1vdXNlV2hlZWwgOiAoZXZlbnQpIC0+IEBtb3ZlIGlmIGV2ZW50LmRlbHRhIDwgMCB0aGVuIC1nLkxQUC8vMiBlbHNlIGcuTFBQLy8yXHJcblx0bW91c2VQcmVzc2VkIDogLT4gXHJcblx0XHRpZiBtb3VzZVkgPiBzY2FsZXkoNClcclxuXHRcdFx0QGN1cnJlbnRSb3cgPSBAb2Zmc2V0ICsgaW50IG1vdXNlWSAvIGcuWk9PTVtnLnN0YXRlXSAtIDQuNVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRmb3Iga2V5LGJ1dHRvbiBvZiBAYnV0dG9uc1xyXG5cdFx0XHRcdGlmIGJ1dHRvbi5hY3RpdmUgYW5kIGJ1dHRvbi5pbnNpZGUgbW91c2VYLG1vdXNlWSB0aGVuIGJ1dHRvbi5jbGljaygpXHJcblxyXG5cdEFycm93VXAgICA6IC0+IEBtb3ZlIC0xXHJcblx0QXJyb3dEb3duIDogLT4gQG1vdmUgMVxyXG5cdFBhZ2VVcCAgICA6IC0+IEBtb3ZlIC1nLkxQUC8vMiBcclxuXHRQYWdlRG93biAgOiAtPiBAbW92ZSBnLkxQUC8vMlxyXG5cdEhvbWUgICAgICA6IC0+IEBtb3ZlIC1AY3VycmVudFJvd1xyXG5cdEVuZCAgICAgICA6IC0+IEBtb3ZlIEBOIC0gQGN1cnJlbnRSb3dcclxuXHJcblx0bW92ZSA6IChkZWx0YSkgLT5cclxuXHRcdEBjdXJyZW50Um93ICs9IGRlbHRhXHJcblx0XHRpZiBAY3VycmVudFJvdyA8IDAgdGhlbiBAY3VycmVudFJvdyA9IDBcclxuXHRcdGlmIEBjdXJyZW50Um93ID49IEBOIHRoZW4gQGN1cnJlbnRSb3cgPSBATi0xXHJcblx0XHRpZiBAY3VycmVudFJvdyA8IEBvZmZzZXQgdGhlbiBAb2Zmc2V0ID0gQGN1cnJlbnRSb3dcclxuXHRcdGlmIEBjdXJyZW50Um93ID49IEBvZmZzZXQgKyBnLkxQUCB0aGVuIEBvZmZzZXQgPSBAY3VycmVudFJvdyAtIGcuTFBQICsgMVxyXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKSJdfQ==
//# sourceURL=c:\github\Dense\coffee\lista.coffee